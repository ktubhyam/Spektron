# Section 6: Discussion

The theoretical framework developed in this paper --- the information completeness ratio (Theorem 1), modal complementarity (Theorem 2), generic identifiability (Conjecture 3), and the Fano lower bound (Proposition 1) --- provides the first formal foundation for understanding the limits and possibilities of molecular identification from vibrational spectra. In this section, we discuss the implications of these results for machine learning model design, acknowledge the limitations of our analysis, connect our work to the broader landscape of inverse problems, and outline directions for future research.


## 6.1 Implications for Machine Learning Model Design

Our theoretical results yield several concrete, actionable principles for the design of spectral identification systems.

**Symmetry-aware architectures should outperform symmetry-agnostic ones.** Theorem 1 establishes that the fraction of vibrational degrees of freedom accessible to IR and Raman spectroscopy is determined by the molecular point group $G$ through the information completeness ratio $R(G, N)$. This quantity imposes a fundamental ceiling on model performance: no algorithm, however sophisticated, can extract information from silent modes that produce no spectral signature. The experimental validation of Section 5.1 confirms that model accuracy correlates strongly with $R(G, N)$, with highly symmetric molecules (low $R$) consistently proving harder to identify. This suggests that architectures incorporating explicit symmetry awareness --- for example, by conditioning on the predicted point group, or by allocating additional representational capacity to molecules with low $R$ values --- should achieve better performance than architectures that treat all molecules identically. The information completeness ratio could also guide curriculum learning strategies, training first on high-$R$ (easy) molecules and progressively introducing low-$R$ (hard) cases.

**Multi-modal pretraining is theoretically justified, not merely empirically motivated.** Theorem 2 provides a rigorous basis for the common empirical practice of training on both IR and Raman data simultaneously. For centrosymmetric molecules, the two modalities probe strictly disjoint sets of vibrational modes; using only one modality leaves a provably non-overlapping set of modes entirely unobserved. The complementarity gain of $\min(N_{\text{IR}}, N_{\text{Raman}})$ additional observable modes is not a statistical estimate but an exact group-theoretic quantity. Our experiments (Section 5.2) confirm the predicted pattern: the accuracy improvement from adding the second modality is substantially larger for centrosymmetric molecules than for non-centrosymmetric ones. This finding has practical significance for model deployment: when resources permit only a single spectroscopic measurement, the choice between IR and Raman should be informed by the expected symmetry distribution of the analyte population. For centrosymmetric analytes, the second modality is not a luxury but a theoretical necessity.

**Model performance limits are partially explainable and predictable.** A recurring frustration in the ML-for-spectroscopy literature is the difficulty of explaining why state-of-the-art models plateau at particular accuracy levels. DiffSpectra [4] achieves 40.76% top-1 accuracy; VibraCLIP [6] reaches 81.7% with auxiliary mass information. Are these limitations algorithmic (improvable with better models) or physical (fundamental)? Our framework provides a partial answer. The information completeness ratio $R(G, N)$ accounts for the information lost to silent modes, and the Fano lower bound (Proposition 1) accounts for the confusion arising from spectrally similar but structurally distinct molecules. Together, these two quantities define a "theoretical difficulty surface" over molecular space: molecules with low $R$ and large confusable set neighborhoods are predicted to be fundamentally hard, while molecules with $R = 1$ and no near-isospectral neighbours are predicted to be identifiable with sufficient data and model capacity. The gap between this theoretical ceiling and current empirical performance quantifies the room remaining for algorithmic improvement. Our analysis of QM9S suggests that a substantial fraction of the current accuracy gap is algorithmic rather than fundamental, particularly for low-symmetry molecules where $R(G, N) = 1$.

**Data augmentation and active learning can be guided by theory.** The information completeness ratio suggests a principled approach to data augmentation: for molecules with $R(G, N) < 1$, augmentation strategies that simulate the effects of symmetry breaking --- isotopic substitution, solvent-induced distortion, or computational perturbation away from high-symmetry geometries --- may provide access to information about otherwise-silent modes. Conversely, for molecules already at $R = 1$, augmentation effort is better spent on improving robustness to noise and instrumental variation. Similarly, active learning protocols could use $R(G, N)$ to prioritize acquiring additional characterization data (e.g., neutron inelastic scattering or hyper-Raman spectra) for molecules where standard IR and Raman are provably incomplete.


## 6.2 Limitations

We acknowledge several important limitations of the present work, organized by whether they affect the theoretical framework, the computational evidence, or the experimental validation.

**Conjecture 3 remains unproven.** The central claim of this paper --- that combined IR+Raman spectra generically determine molecular force constants up to symmetry --- is stated as a conjecture, not a theorem. Our evidence is computational (Jacobian rank analysis, parameter counting, absence of counterexamples) rather than analytical. A rigorous proof would require establishing that the set of configurations where the forward map $\Phi$ fails to be injective has measure zero. The standard approach via Sard's theorem is obstructed by the failure of global smoothness at eigenvalue degeneracies (Section 3.4). Resolving this would likely require tools from semi-algebraic geometry --- since the forward map has a semi-algebraic graph by the Tarski-Seidenberg theorem, one could in principle analyze the dimension of the non-injectivity locus using cylindrical algebraic decomposition --- or from stratified Morse theory, which extends differential-topological tools to piecewise-smooth maps on Whitney-stratified spaces. We regard proving or disproving Conjecture 3 as a significant open problem in applied algebraic geometry.

**The harmonic approximation excludes important spectral features.** Our entire theoretical framework operates within the harmonic approximation: the potential energy surface is expanded to second order, yielding a quadratic Hamiltonian with linear normal modes. Real molecular spectra exhibit numerous anharmonic features --- overtone bands (transitions $v = 0 \to v = 2$), combination bands (simultaneous excitation of two modes), and Fermi resonances (accidental degeneracies between a fundamental and an overtone, leading to intensity borrowing and frequency shifts) --- that are absent from our model. These features carry structural information not captured by harmonic frequencies and intensities alone. Incorporating anharmonic corrections through second-order vibrational perturbation theory (VPT2) [22] or vibrational self-consistent field methods (VSCF) [23] would extend the observable space beyond $4d$ quantities, potentially strengthening the overdetermination argument for Conjecture 3. However, anharmonic corrections also introduce additional parameters and nonlinearities that complicate the identifiability analysis. We leave the extension to anharmonic spectra as future work.

**The phase retrieval problem is partially unresolved.** IR and Raman intensities are proportional to the squared magnitudes of vector (dipole derivative) and tensor (polarizability derivative) projections, respectively. This squaring discards sign (phase) information, reducing the effective information content of each intensity measurement. While the depolarization ratio partially compensates by providing additional constraints on the polarizability tensor components, a complete accounting of how phase loss affects identifiability --- analogous to the well-studied phase retrieval problem in crystallography and coherent diffraction imaging --- has not been carried out. The conservative observable count of $4d$ used in our parameter counting argument (Section 3.4) does not subtract for phase loss, and the true effective dimensionality of the observable space may be somewhat smaller.

**The dataset is limited to small and medium organic molecules.** Our computational evidence (Jacobian rank analysis, confusable set search, and ML experiments) is drawn entirely from the QM9S dataset, which contains molecules with at most 9 heavy atoms composed of C, H, O, N, and F. This restriction limits the generality of our empirical conclusions in several ways. First, larger molecules have denser vibrational spectra with more overlapping peaks, which may increase the practical (if not theoretical) difficulty of identification. Second, molecules containing heavier elements (transition metals, halogens beyond fluorine) have different force constant scales and selection rule patterns. Third, the QM9S spectra are computed at the B3LYP/def2-TZVP level of density functional theory, not measured experimentally. The gap between computed and experimental spectra --- arising from basis set incompleteness, exchange-correlation functional errors, and neglected anharmonicity --- adds an additional layer of uncertainty not captured by our theoretical framework. Extending the analysis to larger molecules, broader chemical diversity, and experimental spectra is an essential next step.

**Force field parameterization assumptions.** The parameter counting argument supporting Conjecture 3 relies on the assumption of a physically sparse valence force field (VFF), where significant force constants are restricted to bonded and near-neighbour interactions. The general valence force field (GVFF), which includes all $d(d+1)/2$ independent elements of the symmetric force constant matrix, is underdetermined for molecules with $N \geq 5$ atoms ($d \geq 9$). Our conjecture therefore applies specifically to force field parameterizations with the molecular graph-induced sparsity that is well-established in the spectroscopic literature [7, 8] and justified by the rapid decay of force constant coupling with graph distance. However, for molecules with extensive conjugation, strong hydrogen bonding networks, or significant through-space interactions, the effective number of independent force constant parameters may exceed the sparse VFF estimate, weakening the overdetermination ratio.

**Conformal prediction guarantees are finite-sample.** The conformal prediction intervals reported in Section 5.6 provide distribution-free coverage guarantees, but these guarantees are marginal (averaging over the calibration set) rather than conditional (holding for each individual test point). With calibration sets of moderate size, the finite-sample coverage may deviate from the nominal level, particularly in the tails of the distribution. Conditional coverage --- a stronger guarantee that is generally unachievable without distributional assumptions --- would require additional structural assumptions about the relationship between spectral features and prediction difficulty.


## 6.3 Connection to Broader Inverse Problems

Our work belongs to a family of inverse spectral and inverse scattering problems that share a common mathematical structure: given partial information about the eigenvalues and eigenvectors of a differential or matrix operator, recover the operator itself. We briefly discuss the connections and distinctions.

**Kac's drum problem.** Kac's original question [1] --- can one hear the shape of a drum? --- concerns the Laplacian eigenvalue spectrum $\{\lambda_n\}$ of a bounded planar domain $\Omega$, asking whether $\{\lambda_n\}$ determines $\Omega$ up to isometry. Gordon, Webb, and Wolpert [2] answered in the negative by constructing non-isometric isospectral domains. A crucial difference from our setting is that Kac's problem uses only eigenvalues (frequencies), with no intensity information. In vibrational spectroscopy, the intensities $a_k$ and $b_k$ provide information about the eigenvectors $\mathbf{L}_k$ through their projections onto the dipole and polarizability derivatives. This additional information fundamentally changes the character of the inverse problem. Indeed, it is known that the Laplacian eigenvalues together with the diagonal values of the heat kernel (which encode eigenvector information analogous to our intensities) do determine the Riemannian metric in many settings [24]. Our conjecture that the molecular inverse problem is generically solvable, while the drum problem is not, reflects this structural difference: we have access to two independent projections of each eigenvector, whereas Kac's problem has none.

**Crystal structure from diffraction.** Wang and Torquato [3] recently posed the crystallographic analog: can one hear the shape of a crystal? Their question concerns whether the diffraction pattern (the squared Fourier moduli of the scattering density) determines the atomic arrangement. This is closely related to the phase retrieval problem in X-ray crystallography, where the measured diffraction intensities lose phase information. Our problem shares this "phase retrieval" aspect --- IR and Raman intensities are squared magnitudes of derivative projections --- but differs in that we observe a finite discrete spectrum (one intensity per normal mode) rather than a continuous diffraction pattern. The overdetermination ratios also differ: in crystallography, the number of measurable Bragg reflections typically far exceeds the number of structural parameters, while in our setting the ratio is more modest ($\sim$4:1 for $C_1$ molecules, declining for higher symmetry).

**Rotational spectroscopy and molecular twins.** Schwarting et al. [25] recently demonstrated the existence of "molecular twins" --- pairs of distinct molecules with nearly identical rotational constants. Since rotational constants depend only on the moments of inertia (three scalar quantities for an asymmetric top), the observable space is far smaller than in vibrational spectroscopy, making non-uniqueness more likely. Our work can be seen as investigating the analogous question for a much richer observable: the full set of vibrational frequencies and intensities provides $O(N)$ constraints compared to the three rotational constants, which is why we conjecture generic identifiability in our setting but would not expect it for rotational spectroscopy alone.

**Quantum state tomography.** The problem of reconstructing a quantum state $\rho$ from measurements in multiple bases bears a structural resemblance to our multi-modal spectroscopic identification problem. In both cases, each measurement basis (or spectroscopic modality) provides partial information about the system, and the question is whether a sufficient collection of measurements determines the state (or structure) uniquely. The analogy is imperfect --- quantum tomography concerns a linear reconstruction problem (for pure states) or a convex optimization problem (for mixed states), while our problem involves a nonlinear forward map --- but the underlying theme of information completeness through complementary observations is shared.

**Graph isomorphism and spectral invariants.** The molecular vibrational spectrum can be viewed as a graph invariant: a function from molecular graphs (with edge weights determined by force constants) to multisets of real numbers (frequencies and intensities). The question of whether this invariant is complete --- whether it distinguishes all non-isomorphic graphs --- is related to the graph isomorphism problem, one of the few natural problems in NP whose complexity status remains unresolved [26]. For general graphs, the eigenvalue spectrum of the adjacency or Laplacian matrix is known to be an incomplete invariant (cospectral non-isomorphic graphs exist). However, our "spectrum" includes not just eigenvalues but also intensity information derived from eigenvector projections, which substantially increases discriminating power. The conjecture that this enriched invariant is generically complete for molecular graphs is a problem at the interface of spectral graph theory and algebraic geometry.


## 6.4 Future Directions

Several avenues for extending this work present themselves.

**Proving or disproving Conjecture 3.** The most important open mathematical question raised by this work is whether the combined IR+Raman spectrum generically determines molecular force constants up to symmetry. We have outlined the technical obstacles: the failure of global smoothness at eigenvalue degeneracies prevents direct application of Sard's theorem, and the semi-algebraic structure of the forward map, while constraining the geometry of the non-injectivity locus, does not by itself establish its measure. A proof might proceed by stratifying the configuration space according to the degeneracy pattern of the $\mathbf{GF}$ matrix and establishing injectivity separately on each stratum, using tools from real algebraic geometry (cylindrical algebraic decomposition, Nash stratifications) or the theory of semi-algebraic maps. Alternatively, a computational algebraic geometry approach --- computing the Grobner basis of the polynomial system defining the forward map and analyzing its variety --- might yield results for specific molecular topologies, even if a fully general proof remains out of reach. We hope that stating Conjecture 3 precisely, together with the supporting evidence, will stimulate work by the mathematical community.

**Extending to other spectroscopic modalities.** The information completeness framework naturally extends beyond IR and Raman spectroscopy. Nuclear magnetic resonance (NMR) spectroscopy probes the magnetic environment of individual nuclei, providing complementary structural information that is largely orthogonal to vibrational data. Mass spectrometry provides molecular formula and fragmentation patterns. Vibrational circular dichroism (VCD) and Raman optical activity (ROA) resolve enantiomers that are indistinguishable by conventional IR and Raman. Each additional modality enlarges the observable space and reduces the size of confusable sets. A generalized information completeness ratio $R_{\text{multi}}(G, N, \mathcal{T})$, where $\mathcal{T}$ denotes the set of techniques employed, would quantify how each technique contributes to resolving the inverse problem and could guide optimal experimental design.

**Incorporating anharmonic corrections.** Extending the theoretical framework beyond the harmonic approximation would both strengthen the identifiability analysis and improve practical applicability. Anharmonic features --- overtones, combination bands, and Fermi resonances --- provide additional structural constraints beyond those captured by $4d$ harmonic observables. Second-order vibrational perturbation theory (VPT2) [22] yields anharmonic frequency corrections and overtone/combination band intensities as functions of cubic and quartic force constants, enlarging both the parameter space and the observable space. The net effect on identifiability is not obvious a priori: more observables improve overdetermination, but more parameters (higher-order force constants) work against it. Quantifying this trade-off is an important open problem.

**Scaling to larger molecules and experimental spectra.** The gap between our computational analysis (DFT-computed spectra of small molecules) and the ultimate application (experimental spectra of complex natural products, pharmaceuticals, and materials) must be bridged. For larger molecules, the vibrational density of states increases and peaks overlap, but so does the number of independent force constant parameters. Whether the overdetermination ratio $d_S / d_F$ increases or decreases with molecular size depends on the scaling of force field sparsity with molecular graph structure --- a question that could be addressed empirically through large-scale Jacobian rank computations on datasets of increasing molecular complexity. For experimental spectra, the additional challenges of noise, baseline drift, and instrument-specific artefacts must be addressed, potentially through the calibration transfer framework discussed in Section 5.5.

**Active learning guided by identifiability theory.** The information completeness ratio $R(G, N)$ and the Fano lower bound together define a "difficulty landscape" over molecular space. Molecules with low $R$ and large confusable set neighborhoods are predicted to be hard; molecules with $R = 1$ and unique spectral fingerprints are predicted to be easy. This landscape could guide active learning strategies: rather than acquiring spectral data uniformly across chemical space, one could preferentially characterize molecules in the theoretically hard regions, where additional data is most informative. For molecules where standard IR and Raman are provably incomplete ($R < 1$), the theory directly suggests which complementary techniques (neutron scattering, hyper-Raman, VCD) would recover the missing information.


---


# Section 7: Conclusion

We have developed the first formal identifiability theory for the spectral inverse problem in vibrational spectroscopy, addressing the molecular analog of Kac's celebrated question: can one hear the shape of a molecule?

Our framework rests on three pillars. First, the information completeness ratio $R(G, N)$ (Theorem 1) provides an exact, computable measure of the fraction of a molecule's vibrational degrees of freedom that are accessible to IR and Raman spectroscopy. This quantity, determined entirely by the molecular point group $G$ and the number of atoms $N$, ranges from 1.0 for molecules with trivial symmetry ($C_1$) to as low as 0.60 for octahedral species ($O_h$), imposing a symmetry-dependent ceiling on the information available to any identification method. We have shown experimentally that $R(G, N)$ is a strong predictor of machine learning model accuracy across molecular symmetry classes.

Second, the modal complementarity theorem (Theorem 2) establishes that for centrosymmetric molecules, IR and Raman spectroscopy probe strictly disjoint sets of vibrational modes, and consequently their combination yields a provable increase in observable degrees of freedom equal to $\min(N_{\text{IR}}, N_{\text{Raman}})$. This classical group-theoretic result, connected here for the first time to machine learning model design, provides the theoretical justification for multi-modal spectral architectures and predicts --- correctly, as our experiments confirm --- that the performance gain from multi-modal fusion is largest for centrosymmetric molecules.

Third, we have presented Conjecture 3, stating that for generic molecules the combined IR+Raman spectrum determines the molecular force constants uniquely up to symmetry equivalence. This conjecture is supported by a 4:1 overdetermination ratio for $C_1$ molecules (independent of molecular size), by full Jacobian rank in all numerically tested non-degenerate configurations, and by the absence of counterexamples in systematic computational searches. We have been explicit about the obstacles to a rigorous proof --- the failure of global smoothness at eigenvalue degeneracies, the semi-algebraic structure of the forward map, and the partially unresolved phase retrieval aspect --- and we state this result as a conjecture rather than a theorem.

Complementing the identifiability analysis, the Fano lower bound (Proposition 1) provides algorithm-independent lower bounds on identification error for confusable molecular sets, while our symmetry-aware ML model demonstrates that theory-informed architectural choices --- multi-modal cross-attention, variational information bottleneck, wavenumber positional encoding --- yield competitive performance with principled uncertainty quantification through conformal prediction.

We cannot yet prove that one can hear the shape of a molecule. But we have strong computational evidence that one generically can --- and we understand precisely which molecular symmetries make it harder, which spectroscopic modalities are needed, and where the fundamental limits of identification lie. By connecting sixty years of group-theoretic spectroscopy with modern machine learning, we hope this work provides a foundation for the rigorous, theory-guided development of spectral identification systems and stimulates further mathematical investigation into the identifiability of molecular inverse problems.

---

## References

[1] M. Kac, "Can one hear the shape of a drum?", *American Mathematical Monthly* **73**(4), 1--23 (1966).

[2] C. Gordon, D. L. Webb, S. Wolpert, "One cannot hear the shape of a drum", *Bulletin of the American Mathematical Society* **27**(1), 134--138 (1992).

[3] J. Wang, S. Torquato, "Can one hear the shape of a crystal?", preprint (2025).

[4] DiffSpectra: Diffusion-based molecular generation from IR and Raman spectra, arXiv:2507.06853 (2025).

[6] VibraCLIP: Contrastive learning for vibrational spectroscopy and molecular structure, *RSC Digital Discovery* (2025).

[7] I. M. Mills, "The calculation of accurate normal coordinates and force constants from observed frequencies", *Spectrochimica Acta* **22**, 561--570 (1966).

[8] G. M. Kuramshina et al., "Joint treatment of ab initio and experimental data in molecular force field calculations with Tikhonov regularization", *Journal of Chemical Physics* **100**, 2516--2524 (1994).

[22] V. Barone, "Anharmonic vibrational properties by a fully automated second-order perturbative approach", *Journal of Chemical Physics* **122**, 014108 (2005).

[23] J. M. Bowman, "Self-consistent field energies and wavefunctions for coupled oscillators", *Journal of Chemical Physics* **68**, 608--610 (1978).

[24] S. Zelditch, "Spectral determination of analytic bi-axisymmetric plane domains", *Geometric and Functional Analysis* **10**, 628--677 (2000).

[25] M. Schwarting, N. A. Seifert, M. J. Davis, B. H. Pate, "Molecular twins: spectroscopic identification challenges from nearly identical rotational spectra", *Journal of Chemical Physics* **160**, 201101 (2024).

[26] L. Babai, "Graph isomorphism in quasipolynomial time", in *Proceedings of the 48th Annual ACM Symposium on Theory of Computing (STOC)*, 684--697 (2016).
